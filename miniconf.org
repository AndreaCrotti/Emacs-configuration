MINIMAL EMACS CONFIGURATION
* TODO See if it's possible to have python auto completion without ropemacs
* TODO Make the table of software versions regenerating every time
* TODO Write a function that setups all the possible paths automatically
* TODO Something about latex might also be necessary

* Some useful functions
#+begin_src emacs-lisp :tangle yes
  (defun make-path (path)
    (concat conf path))
#+end_src
 
* Operating system detection
#+begin_src emacs-lisp :tangle yes
(defconst linux (string-match "linux" system-configuration))
(defconst mac (string-match "apple" system-configuration))
(defconst win (string-match "win" system-configuration))
#+end_src

** Mac configuration
#+begin_src emacs-lisp :tangle yes
(if mac
    (progn
      (add-to-list 'exec-path "/opt/local/bin")
      (setq ns-alternate-modifier (quote none))
      (setq ns-command-modifier (quote meta))))
#+end_src

* Org mode
** Clock configuration
#+begin_src emacs-lisp :tangle yes
;; Clock configuration
(setq org-clock-persist t)
(org-clock-persistence-insinuate)
#+end_src

** Add eventually
#+begin_src emacs-lisp :tangle yes
(defun org-add-eventually()
  "Adding a file to org-agenda when saved"
  (interactive)
  (if (and
       (string= major-mode "org-mode")
       (not (member buffer-file-name org-agenda-files))
       (yes-or-no-p "add the file to agenda?"))
      (org-agenda-file-to-front)))

(add-hook 'before-save-hook 'org-add-eventually)
#+end_src

* Yasnippet
#+begin_src emacs-lisp :tangle yes
  (require 'yasnippet)
  
  (setq yas/root-directory
        (mapcar 'make-path
                '("yasnippet/" "my-snippets/")))
  
  ;; Maybe needed to set to fixed for some modes
  (setq yas/indent-line 'auto)
  
  (yas/initialize)
  
  (setq yas/ignore-filenames-as-triggers nil)
  
  (mapc 'yas/load-directory yas/root-directory)
  
  ;; don't make backups in the snippet folder, they mess up yasnippet
  (add-to-list 'backup-directory-alist '("/my-snippets/" . "/tmp/"))
#+end_src

* Auto complete
** Importing all packages
#+begin_src emacs-lisp :tangle yes
  ;;; Require
  (require 'auto-complete)
  ;; Various configurations
  (require 'auto-complete-config)
  (require 'auto-complete-extension nil t) ;optional
  (require 'auto-complete-yasnippet nil t) ;optional
  (require 'auto-complete-semantic nil t)  ;optional
  (require 'auto-complete-gtags nil t)     ;optional
  (require 'auto-complete-octave)
  
  ;; Generic setup.
  (global-auto-complete-mode t)           ;enable global-mode
  
  (setq ac-auto-start 3)                  ;automatically start
  (setq ac-override-local-map nil)        ;don't override local map
  
  (define-key ac-complete-mode-map "\C-n" 'ac-next)
  (define-key ac-complete-mode-map "\C-p" 'ac-previous)
#+end_src
  
* Python mode
#+begin_src emacs-lisp :tangle no
(add-to-list 'load-path (concat conf "python-mode/"))
(add-to-list 'auto-mode-alist (cons '("\\.py$" . python-mode)))
(add-to-list 'interpreter-mode-alist (cons '("python" . python-mode)))
(autoload 'python-mode "python-mode" "Python editing mode." t)
#+end_src

* General settings
** Custom file
#+begin_src emacs-lisp :tangle yes
(setq custom-file (concat base "custom.el"))
#+end_src

** Showing more things
#+begin_src emacs-lisp :tangle yes
(display-time-mode 1)
(transient-mark-mode 1)
(setq inhibit-startup-message t)
(setq initial-scratch-message nil)

(show-paren-mode t)
(column-number-mode t)
;; always truncate lines (useful for netbook), not working yet in ORG MODE
(setq truncate-lines nil)
;; Setting indent-tabs-mode for only spaces
(setq-default indent-tabs-mode nil)
#+end_src

** IDO mode
#+begin_src emacs-lisp :tangle yes
(require 'ido)
(ido-mode t)
#+end_src

* Flymake (pylint ...)
** Setting up flymake
#+begin_src emacs-lisp :tangle yes
(require 'flymake)
   
(defun activate-flymake ()
  "Activates flymake when real buffer and you have write access"
  (if (and
       (buffer-file-name)
       (file-writable-p buffer-file-name))
      (flymake-mode t)))
#+end_src

** Flymake for python
   
#+begin_src emacs-lisp :tangle yes
(defun flymake-python-init () 
  (let* ((temp-file (flymake-init-create-temp-buffer-copy 
		     'flymake-create-temp-inplace)) 
	 (local-file (file-relative-name 
		      temp-file 
		      (file-name-directory buffer-file-name)))) 
    (list "pycheckers" (list local-file))))

(add-to-list 'flymake-allowed-file-name-masks 
	     '("\\.py\\'" flymake-python-init))

;; Using function is preferred when quoting functions
(add-hook 'python-mode-hook (function activate-flymake))
#+end_src

* Versions of software
  In this table we collect the actual version of the packages used

  | PKG           | version                                      |
  |---------------+----------------------------------------------|
  | emacs         | GNU Emacs 23.1.50.1                          |
  | python mode   |                                              |
  | yasnippet     | yasnippet (version 0.6.1b)                   |
  | auto-complete |                                              |
  | org-mode      | Org-mode version 6.35f (release_6.35f.dirty) |
  #+TBLFM: @2$2='(emacs-version)::@3$2='(yas/about)::@5$2='(org-version)
